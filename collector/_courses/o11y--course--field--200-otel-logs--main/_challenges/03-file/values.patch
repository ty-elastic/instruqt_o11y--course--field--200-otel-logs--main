--- ../values.yaml	2025-12-08 09:40:43
+++ o11y--course--field--200-otel-logs--main/_challenges/03-file/values.yaml	2025-12-08 09:40:53
@@ -195,6 +195,26 @@
             - key: data_stream.dataset
               from_attribute: service.name
               action: upsert
+        transform/parse_json_body:
+            error_mode: ignore
+            log_statements:
+              - context: log
+                conditions:
+                  - body != nil and Substring(body, 0, 2) == "{\""
+                statements:
+                  - set(cache, ParseJSON(body))
+                  - flatten(cache, "")
+                  - merge_maps(attributes, cache, "upsert")
+
+                  - set(time, Time(attributes["_meta.date"], "%Y-%m-%dT%H:%M:%SZ"))
+                  - set(severity_text, attributes["_meta.logLevelName"])
+                  - set(severity_number, attributes["_meta.logLevelId"])
+                  - delete_matching_keys(attributes, "_meta\\..*")
+
+                  - set(body, attributes["0"])
+                  - delete_key(attributes, "0")
+
+                  - replace_all_patterns(attributes, "key", "\\d+\\.", "")
         # [Batch Processor](https://github.com/open-telemetry/opentelemetry-collector/tree/main/processor/batchprocessor)
         batch: {} # inherit any values from helm chart
         batch/metrics:
@@ -437,6 +457,7 @@
             receivers:
               - filelog
             processors:
+              - transform/parse_json_body
               - batch
               - k8sattributes
               - resourcedetection/system
